# 桌面设计

## 菜单和状态栏

​	桌面顶部显示菜单和状态栏，用与实现系统状态和程序菜单

### 菜单栏

​	显示当前程序的菜单，默认显示桌面菜单

1. 增加菜单实体类
   1. 名称
   2. 图标
   3. 激活 (class="active")
   4. 可用性
   5. 可见性
   6. 类型
      1. 按钮
      2. 复选框
      3. 分割线
   7. Key (用于@key)
   8. 特殊class样式
   9. 子菜单集合 (树形结构)
   
2. 增加菜单栏交互类及菜单栏交互接口

   > 设计原则：组合优于继承

   1. 获取菜单实体集合
   2. 处理菜单项事件回调方法 (传入具体的菜单项作为参数)

3. 程序和桌面增加菜单栏交互接口的成员以设计自身的菜单栏功能

4. 当切换激活的程序时通知菜单栏

   1. 菜单栏获取当前激活的程序并判断此程序的菜单栏交互接口是否有引用 (空引用则视为不需要菜单栏功能)
      1. 是 => 通过程序的菜单栏交互接口成员获取程序的菜单实体集合
      2. 否 => 通过桌面的菜单栏交互接口成员获取桌面的菜单实体集合
   2. 渲染菜单栏
      1. 使用菜单栏渲染器渲染菜单栏
      2. 支持多级菜单
   3. 菜单项事件回调
      1. 通过支持菜单的接口回调程序实现的菜单事件处理方法
   4. 更新菜单状态
      1. 程序内更新菜单实体的属性时，菜单栏应响应这些变化
   5. 提供两种菜单栏渲染器接口的实现
      1. 按照现有方案，通过菜单实体渲染出菜单组件，并返回RenderFragment\<TValue>类型的菜单组件
      2. 自定义方案，由程序设计自定义的菜单栏组件，并通过子内容引用到程序的RenderFragment\<TValue>类型的成员，渲染器返回该成员

### 状态栏

​	显示当前系统状态

1. TODO: 设计方案类似以上

## 图标容器

​	桌面主体部分为图标容器，用于显示用户的程序（图标和名称）

1. ~~容器背景使用 backdropoff-filter 效果~~
2. ~~图标使用响应式排列，在不同尺寸显示不同的列数~~
3. 顶部控件组筛选程序图标：分类下拉框(全部(默认)|系统|办公|娱乐|...)，状态下拉框(可见(默认)|全部|隐藏)，名称搜索框，
4. ~~图标鼠标进入和离开显示效果~~
5. ~~使用拉伸链接统一处理整个卡片的事件~~
6. 图标右键菜单
   1. 打开
   2. 隐藏/取消隐藏
   3. 固定/取消固定 到程序坞
   4. 重命名
   5. 固定到页顶部
   6. 删除

## 程序坞

​	悬浮在桌面下方，用于固定显示常用的程序

1. ~~容器背景使用 backdropoff-filter 效果~~
2. ~~固定一行显示，图标 mt-n5 以突出显示图标~~
3. ~~宽度根据内容适应，居中显示~~
4. ~~图标鼠标进入和离开显示效果，放大缩小~~
5. ~~使用拉伸链接同一处理整个卡片的事件~~
6. 图标右键菜单
   1. 打开
   2. 取消固定到程序坞

## 信息面板

​	桌面主体浮动显示信息面板，用于显示数据信息（天气、时间、任务...）

# 应用商店

​	用于显示已发售的应用程序

1. 显示所有可用的程序
2. 供用户启用自己喜欢的程序

# API

## 程序API

​	~~仅允许Hacker角色访问~~

1. ~~获取当前用户的所有程序及映射~~
   1. ~~返回当前授权用户的NameClaim返回其程序，及用户对程序的映射信息~~
   2. ~~程序图标返回一个指向程序资源API的URL~~
2. ~~设置用户对程序的隐藏字段~~
3. ~~设置用户对程序的固定到坞字段~~
4. ~~设置用户对程序的固定到顶部字段~~
5. ~~设置用户对程序的重命名字段~~
6. ~~删除用户对程序的映射~~

## 程序资源API

1. 获取程序的图标文件及其它资源
2. 实现一个Resource服务用于封装文件IO实现上传(Admin)和下载程序资源

## 应用商店API

​	仅允许Hacker和Commander角色访问

1. 获取所有可用的程序
2. 上架应用程序
3. 禁用/启用应用程序
4. 下架应用程序

## 数据模型

### Program

1. ~~记录程序基本信息~~

### UserProgramMap

1. ~~记录用户对程序的映射信息~~
   1. ~~隐藏~~
   2. ~~固定到坞~~
   3. ~~固定到顶部~~
   4. ~~重命名~~



# Z-Index

## 桌面

### 图标容器

```scss
$zindex-iconcontainer:    0-49 !default;
```

### 信息面板

```scss
$zindex-infopanel:    50-149 !default;
```

### 程序坞

```scss
$zindex-programdock:    150-199 !default;
```

## 程序

### 普通程序

```scss
$zindex-normalprogram:    200-849 !default;
```

### 置顶程序

```scss
$zindex-topprogram:    850-999 !default;
```

## Bootstrap 保留

```scss
$zindex-dropdown:          1000 !default;
$zindex-sticky:            1020 !default;
$zindex-fixed:             1030 !default;
$zindex-modal-backdrop:    1040 !default;
$zindex-modal:             1050 !default;
$zindex-popover:           1060 !default;
$zindex-tooltip:           1070 !default;
```

